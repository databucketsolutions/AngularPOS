<br>
<a mat-raised-button color="primary" [routerLink]="['/menu']"><mat-icon>arrow_back</mat-icon></a>

<h1>{{this.pageType}} Menu Item</h1>

<form class="card" [formGroup]="itemCreateForm" (ngSubmit)="onFormSubmit(itemCreateForm.value)">

  <mat-form-field class="full-width">
    <input matInput placeholder="Name" formControlName="name" [errorStateMatcher]="matcher">
    <mat-error>
      <span *ngIf="!itemCreateForm.get('name').valid && itemCreateForm.get('name').touched">Please enter a Name</span>
    </mat-error>
  </mat-form-field>


  <mat-form-field class="full-width">
    <mat-chip-list #categoryChipList>
      <mat-chip
        *ngFor="let category of selectedCategories"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(category, 'selectedCategories')"> 
        {{category}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="Category"
        #categoryInput
        [formControl]="categoryCtrl"
        [matAutocomplete]="autoCategory" 
        [matChipInputFor]="categoryChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'categoryCtrl', 'category')">
    </mat-chip-list>
    <mat-autocomplete #autoCategory="matAutocomplete" (optionSelected)="selected($event, 'selectedCategories', 'categoryInput', 'categoryCtrl', 'categories')">
      <mat-option *ngFor="let category of filteredCategories | async" [value]="category">
        {{category}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>


  <mat-form-field class="full-width">
    <mat-chip-list #optionChipList>
      <mat-chip
        *ngFor="let option of selectedOptions"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(option, 'selectedOptions')"> 
        {{option}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="Options"
        #optionInput
        [formControl]="optionCtrl"
        [matAutocomplete]="autoOption" 
        [matChipInputFor]="optionChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'optionCtrl', 'option')">
    </mat-chip-list>
    <mat-autocomplete #autoOption="matAutocomplete" (optionSelected)="selected($event, 'selectedOptions', 'optionInput', 'optionCtrl', 'options')">
      <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
        {{option}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>


   <mat-form-field class="full-width">
    <mat-chip-list #modifierChipList>
      <mat-chip
        *ngFor="let modifier of selectedModifiers"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(modifier,'selectedModifiers')">
        {{modifier}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="Modifiers"
        #modifierInput
        [formControl]="modifierCtrl"
        [matAutocomplete]="autoModifier"
        [matChipInputFor]="modifierChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'modifierCtrl','modifier')">
    </mat-chip-list>
    <mat-autocomplete #autoModifier="matAutocomplete" (optionSelected)="selected($event, 'selectedModifiers', 'modifierInput', 'modifierCtrl', 'modifiers')">
      <mat-option *ngFor="let modifier of filteredModifiers | async" [value]="modifier">
        {{modifier}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>


  <mat-form-field class="full-width">
    <mat-chip-list #taxChipList>
      <mat-chip
        *ngFor="let tax of selectedTaxes"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(tax,'selectedTaxes')">
        {{tax}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="Taxes"
        #taxInput
        [formControl]="taxCtrl"
        [matAutocomplete]="autoTax"
        [matChipInputFor]="taxChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'taxCtrl','tax')">
    </mat-chip-list>
    <mat-autocomplete #autoTax="matAutocomplete" (optionSelected)="selected($event, 'selectedTaxes', 'taxInput', 'taxCtrl', 'taxes')">
      <mat-option *ngFor="let tax of filteredTaxes | async" [value]="tax">
        {{tax}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>


  <mat-form-field class="full-width">
    <mat-chip-list #componentChipList>
      <mat-chip
        *ngFor="let component of selectedComponents"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(component,'selectedComponents')">
        {{component}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="Components"
        #componentInput
        [formControl]="componentCtrl"
        [matAutocomplete]="autoComponent"
        [matChipInputFor]="componentChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'componentCtrl','component')">
    </mat-chip-list>
    <mat-autocomplete #autoComponent="matAutocomplete" (optionSelected)="selected($event, 'selectedComponents', 'componentInput', 'componentCtrl', 'components')">
      <mat-option *ngFor="let component of filteredComponents | async" [value]="component">
        {{component}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <mat-form-field class="full-width">
    <mat-chip-list #typeChipList>
      <mat-chip
        *ngFor="let type of selectedTypes"
        [selectable]="selectable"
        [removable]="removable"
        (removed)="remove(type,'selectedTypes')">
        {{type}}
        <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
      </mat-chip>
      <input
        placeholder="types"
        #typeInput
        [formControl]="typeCtrl"
        [matAutocomplete]="autoType"
        [matChipInputFor]="typeChipList"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="addOnBlur"
        (matChipInputTokenEnd)="add($event, 'typeCtrl','type')">
    </mat-chip-list>
    <mat-autocomplete #autoType="matAutocomplete" (optionSelected)="selected($event, 'selectedTypes', 'typeInput', 'typeCtrl', 'types')">
      <mat-option *ngFor="let type of filteredTypes | async" [value]="type">
        {{type}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>


  <mat-form-field class="full-width">
    <textarea matInput placeholder="Description" formControlName="description" [errorStateMatcher]="matcher"></textarea>
    <mat-error>
      <span *ngIf="!itemCreateForm.get('description').valid && itemCreateForm.get('description').touched">Please enter Item Description</span>
    </mat-error>
  </mat-form-field>

  <mat-form-field class="full-width">
    <input matInput placeholder="Price" formControlName="price" type="number" step="0.01" value="0.00" [errorStateMatcher]="matcher">
    <mat-error>
      <span *ngIf="!itemCreateForm.get('price').valid && itemCreateForm.get('price').touched">Please enter a Price</span>
    </mat-error>
  </mat-form-field>

  <div class="button-row">
    <button type="submit" [disabled]="!itemCreateForm.valid" mat-raised-button color="primary">
      <mat-icon>save</mat-icon>
    </button>
    <button  [routerLink]="['/']" [disabled]="!itemCreateForm.valid" mat-raised-button color="warn">
      <mat-icon>cancel</mat-icon>
    </button>
  </div>

</form>